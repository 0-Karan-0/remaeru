<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <link rel="stylesheet" href="assets/style.css">
  <link rel="stylesheet" href="assets/loading.css">
</head>
<body class="page-loading">
  <div class="contianer">
<div class="gauge-section">
<svg width="380" height="300" viewBox="0 0 380 300" fill="none" xmlns="http://www.w3.org/2000/svg">
<g filter="url(#filter0_di_1_76)">
<circle cx="189.464" cy="149.901" r="125.893" transform="rotate(37.9338 189.464 149.901)" fill="#316631"/>
</g>
<path d="M63.5715 149.464C63.5715 127.972 69.0736 106.838 79.5537 88.0748C90.0339 69.3113 105.143 53.5432 123.442 42.2723L136.647 63.7107C122.007 72.7274 109.92 85.3419 101.536 100.353C93.1517 115.363 88.75 132.271 88.75 149.464H63.5715Z" fill="url(#paint0_linear_1_76)"/>
<path d="M252.525 40.5043C233.398 29.4348 211.695 23.595 189.596 23.5718C167.497 23.5486 145.782 29.3429 126.632 40.3722L139.198 62.1907C154.518 53.3672 171.891 48.7318 189.57 48.7503C207.249 48.7689 224.611 53.4407 239.913 62.2963L252.525 40.5043Z" fill="url(#paint1_linear_1_76)"/>
<path d="M255.245 42.0341C274.062 53.6218 289.497 69.9586 299.999 89.4024C310.501 108.846 315.7 130.712 315.074 152.802L289.905 152.088C290.407 134.416 286.247 116.923 277.846 101.368C269.444 85.8132 257.096 72.7438 242.042 63.4736L255.245 42.0341Z" fill="url(#paint2_linear_1_76)"/>
<g filter="url(#filter2_d_1_76)">
<path d="M51.0986 149.58C51.0986 126.004 57.1178 102.818 68.5859 82.219C80.0541 61.6198 96.5915 44.2897 116.631 31.8702L120.279 37.7557C101.241 49.5542 85.5304 66.0179 74.6357 85.5871C63.7409 105.156 58.0227 127.183 58.0227 149.58H51.0986Z" fill="url(#paint3_linear_1_76)"/>
</g>
<g filter="url(#filter3_d_1_76)">
<path d="M258.947 29.7236C237.908 17.5472 214.034 11.1234 189.726 11.0979C165.417 11.0724 141.53 17.446 120.465 29.5783L123.921 35.5784C143.932 24.0527 166.625 17.9977 189.718 18.022C212.812 18.0462 235.492 24.1488 255.479 35.7164L258.947 29.7236Z" fill="url(#paint4_linear_1_76)"/>
</g>
<g filter="url(#filter4_d_1_76)">
<path d="M262.354 31.7613C283.036 44.5358 299.99 62.5292 311.514 83.933C323.037 105.337 328.724 129.397 328.001 153.695L321.08 153.489C321.767 130.406 316.364 107.549 305.417 87.2153C294.47 66.8817 278.363 49.788 258.716 37.6522L262.354 31.7613Z" fill="url(#paint5_linear_1_76)"/>
</g>
<g filter="url(#filter5_d_1_76)" id="needle">
<path d="M50.7362 139.018L85.8933 136.9C87.2712 136.817 88.4316 137.917 88.4214 139.298V139.298C88.4111 140.678 87.2345 141.762 85.8579 141.658L50.7362 139.018Z" fill="white"/>
</g>
  <g filter="url(#filter1_d_1_76)">
    <text
      id="count"
      x="189.464"
      y="149.901"
      font-size="99"
      text-anchor="middle"
      dominant-baseline="middle"
      fill="white"
    >
      10
    </text>
  </g>
<defs>
<filter id="filter0_di_1_76" x="54.9944" y="19.7171" width="268.94" height="268.94" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dy="4.28571"/>
<feGaussianBlur stdDeviation="4.28571"/>
<feComposite in2="hardAlpha" operator="out"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_76"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_76" result="shape"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dx="2.14286" dy="-2.14286"/>
<feGaussianBlur stdDeviation="4.28571"/>
<feComposite in2="hardAlpha" operator="arithmetic" k2="-1" k3="1"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"/>
<feBlend mode="normal" in2="shape" result="effect2_innerShadow_1_76"/>
</filter>
<filter id="filter1_d_1_76" x="75.6581" y="61.0731" width="226.635" height="188.776" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset/>
<feGaussianBlur stdDeviation="32.1429"/>
<feComposite in2="hardAlpha" operator="out"/>
<feColorMatrix type="matrix" values="0 0 0 0 0.807843 0 0 0 0 0.941176 0 0 0 0 0.435294 0 0 0 1 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_76"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_76" result="shape"/>
</filter>
<filter id="filter2_d_1_76" x="43.5986" y="21.1559" width="86.3231" height="134.853" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dx="1.07143" dy="-2.14286"/>
<feGaussianBlur stdDeviation="4.28571"/>
<feComposite in2="hardAlpha" operator="out"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 1 0 0 0 0 0.482353 0 0 0 0.5 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_76"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_76" result="shape"/>
</filter>
<filter id="filter3_d_1_76" x="112.965" y="1.45494" width="155.625" height="41.7615" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dx="1.07143" dy="-1.07143"/>
<feGaussianBlur stdDeviation="4.28571"/>
<feComposite in2="hardAlpha" operator="out"/>
<feColorMatrix type="matrix" values="0 0 0 0 0.988235 0 0 0 0 0.956863 0 0 0 0 0.00784314 0 0 0 0.5 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_76"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_76" result="shape"/>
</filter>
<filter id="filter4_d_1_76" x="251.216" y="22.1184" width="86.4898" height="139.076" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dx="1.07143" dy="-1.07143"/>
<feGaussianBlur stdDeviation="4.28571"/>
<feComposite in2="hardAlpha" operator="out"/>
<feColorMatrix type="matrix" values="0 0 0 0 0.956863 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_76"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_76" result="shape"/>
</filter>
<filter id="filter5_d_1_76" x="46.4505" y="134.752" width="46.2567" height="13.3411" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
<feFlood flood-opacity="0" result="BackgroundImageFix"/>
<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
<feOffset dy="2.14286"/>
<feGaussianBlur stdDeviation="2.14286"/>
<feComposite in2="hardAlpha" operator="out"/>
<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/>
<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1_76"/>
<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1_76" result="shape"/>
</filter>
<linearGradient id="paint0_linear_1_76" x1="124.643" y1="45" x2="61.2002" y2="148.609" gradientUnits="userSpaceOnUse">
<stop stop-color="#00FF7B"/>
<stop offset="1" stop-color="#00E06C"/>
</linearGradient>
<linearGradient id="paint1_linear_1_76" x1="252.525" y1="40.5043" x2="129.464" y2="41.2503" gradientUnits="userSpaceOnUse">
<stop stop-color="#FCF402"/>
<stop offset="1" stop-color="#F5ED02"/>
</linearGradient>
<linearGradient id="paint2_linear_1_76" x1="317.5" y1="148.929" x2="251.611" y2="39.88" gradientUnits="userSpaceOnUse">
<stop stop-color="#F40000"/>
<stop offset="1" stop-color="#E00000"/>
</linearGradient>
<linearGradient id="paint3_linear_1_76" x1="118.277" y1="34.6697" x2="48.4902" y2="148.64" gradientUnits="userSpaceOnUse">
<stop stop-color="#00FF7B"/>
<stop offset="1" stop-color="#00E06C"/>
</linearGradient>
<linearGradient id="paint4_linear_1_76" x1="258.947" y1="29.7236" x2="123.581" y2="30.5442" gradientUnits="userSpaceOnUse">
<stop stop-color="#FCF402"/>
<stop offset="1" stop-color="#F5ED02"/>
</linearGradient>
<linearGradient id="paint5_linear_1_76" x1="330.676" y1="149.247" x2="258.198" y2="29.2933" gradientUnits="userSpaceOnUse">
<stop stop-color="#F40000"/>
<stop offset="1" stop-color="#E00000"/>
</linearGradient>
</defs>
</svg>
<div class="calculating-label" id="calculatingText">Calculating your score...</div>
</div>
</div>
<script>
  const minValue = 10,
        maxValue = 30,
        startAng = -5,
        endAng   = 175;

  function animateNeedle(toValue, callback) {
    toValue = Math.max(minValue, Math.min(maxValue, toValue));

    const txt = document.getElementById('count');
    const needle = document.getElementById('needle');

    let tf = needle.getAttribute('transform') || '',
        match = /rotate\(\s*([-\d.]+)\s*/.exec(tf),
        curAng = match ? parseFloat(match[1]) : startAng;

    const tgtAng = startAng +
      ((toValue - minValue) / (maxValue - minValue)) *
      (endAng - startAng);

    let velocity = 0,
        stiffness = 0.02,
        damping = 0.15;

    function step() {
      const force = -stiffness * (curAng - tgtAng);
      velocity += force;
      velocity *= (1 - damping);
      curAng += velocity;

      needle.setAttribute('transform', `rotate(${curAng.toFixed(2)} 189.464 149.901)`);

      const pct = (curAng - startAng) / (endAng - startAng);
      txt.textContent = Math.round(minValue + pct * (maxValue - minValue));

      if (Math.abs(velocity) > 0.01 || Math.abs(curAng - tgtAng) > 0.01) {
        requestAnimationFrame(step);
      } else {
        needle.setAttribute('transform', `rotate(${tgtAng} 189.464 149.901)`);
        txt.textContent = toValue;

        if (typeof callback === 'function') {
          callback();
        }
      }
    }

    requestAnimationFrame(step);
  }

  window.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const realScore = parseInt(urlParams.get('score')) || 10;
    const category = urlParams.get('category') || ''; // NEW: get category from URL if present

    let fakeMove = 0;
    let calculatingInterval;

    const calculatingText = document.getElementById('calculatingText');

    function startCalculatingAnimation() {
      let dots = 0;
      calculatingInterval = setInterval(() => {
        dots = (dots + 1) % 4;
        calculatingText.textContent = 'Calculating your score' + '.'.repeat(dots);
      }, 500);
    }

    function stopCalculatingAnimation() {
      clearInterval(calculatingInterval);
      calculatingText.textContent = 'Your score is ready!';
    }

    function doFakeMove() {
      fakeMove++;
      const randomScore = Math.floor(minValue + Math.random() * (maxValue - minValue));

      animateNeedle(randomScore, () => {
        if (fakeMove < 4) {
          setTimeout(doFakeMove, 300); // pause between moves
        } else {
          // Final real move
          animateNeedle(realScore, () => {
            stopCalculatingAnimation();
            setTimeout(() => {
              // Redirect and pass score + category
              window.location.href = `result.html?score=${realScore}&category=${encodeURIComponent(category)}`;
            }, 2000);
          });
        }
      });
    }

    startCalculatingAnimation();
    doFakeMove();
  });
</script>


</body>
</html>
